version: "3"

#volumes:
#  squad_data:
#    name: "/srv/core/portainer-volumes/squad_data_${ENV_NAME:-test}"

services:
  squad-server:
    image: cm2network/squad
    container_name: "squad-${ENV_NAME:-test}"
    network_mode: "${NETWORK_MODE:-host}"
    restart: unless-stopped
    volumes:
      #- squad_data:/home/steam/squad-dedicated/
      #- "/srv/core/portainer-volumes/squad-data-test:/home/steam/squad-dedicated/"
    environment:
      - PORT=${SERVER_PORT:-7787}
      - beaconport=${BEACON_PORT:-15000}
      - QUERYPORT=${QUERY_PORT:-27165}
      - RCONPORT=${RCON_PORT:-21114}
      - FIXEDMAXPLAYERS=${MAX_PLAYERS:-100}
      - SERVER_NAME=${SERVER_NAME:-Default Squad Server}
      - MODS=${MODS}
    ports:
      - "${SERVER_IP}:${SERVER_PORT:-7787}:${SERVER_PORT:-7787}/tcp"
      - "${SERVER_IP}:${SERVER_PORT:-7787}:${SERVER_PORT:-7787}/udp"
      - "${SERVER_IP}:${SERVER_PORT_ADDITIONAL:-7788}:${SERVER_PORT_ADDITIONAL:-7788}/tcp"
      - "${SERVER_IP}:${SERVER_PORT_ADDITIONAL:-7788}:${SERVER_PORT_ADDITIONAL:-7788}/udp"
      - "${SERVER_IP}:${BEACON_PORT:-15000}:${BEACON_PORT:-15000}/tcp"
      - "${SERVER_IP}:${BEACON_PORT:-15000}:${BEACON_PORT:-15000}/udp"
      - "${SERVER_IP}:${QUERY_PORT:-27165}:${QUERY_PORT:-27165}/tcp"
      - "${SERVER_IP}:${QUERY_PORT:-27165}:${QUERY_PORT:-27165}/udp"
      - "${SERVER_IP}:${QUERY_PORT_ADDITIONAL:-27166}:${QUERY_PORT_ADDITIONAL:-27166}/tcp"
      - "${SERVER_IP}:${QUERY_PORT_ADDITIONAL:-27166}:${QUERY_PORT_ADDITIONAL:-27166}/udp"
      - "${SERVER_IP}:${RCON_PORT:-21114}:${RCON_PORT:-21114}/tcp"
      - "${SERVER_IP}:${RCON_PORT:-21114}:${RCON_PORT:-21114}/udp"
